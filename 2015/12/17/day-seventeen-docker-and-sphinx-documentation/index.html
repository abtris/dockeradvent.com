<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Day Seventeen - Docker and Sphinx documentation &middot; Docker Advent
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          Docker Advent
        </a>
      </h1>
      <p class="lead">Made by <a href="https://twitter.com/abtris" target="_blank">@abtris</a>.</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
      
        
      
        
          
        
      
        
      
        
          
        
      
        
          
        
      

      <a class="sidebar-nav-item" href="https://github.com/abtris/dockeradvent.com">GitHub project</a>
    </nav>

    <p>&copy; 2015. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="post">
  <h1 class="post-title">Day Seventeen - Docker and Sphinx documentation</h1>
  <span class="post-date">17 Dec 2015</span>
  <p>Hi everyone,<br>
if you write the docs, you can use <a href="http://sphinx-doc.org/">Sphinx</a>. You can share your documentation using <a href="https://readthedocs.org/">Read the Docs</a> portal.</p>

<p>If you look at <a href="https://docs.readthedocs.org/en/latest/getting_started.html#write-your-docs">quickstart</a> how write the docs, you can install python and some tools. This can be complicated if you can use latex for creating PDF version and do you need another version python for your development and some another for write the docs. Some members of your team can&#39;t install anything for update just a few lines.</p>

<h2>Docker solution for Sphinx</h2>

<p>You can use <a href="https://hub.docker.com/r/apiaryio/base-sphinx-doc-dev/">docker image</a>. There is <code>requirements.txt</code> for all python packages:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">Sphinx&gt;=1.3.1
awscli==1.5.2
sphinx_rtd_theme
recommonmark
</code></pre></div>
<p>and Dockerfile based on debian.</p>
<div class="highlight"><pre><code class="language-dockerfile" data-lang="dockerfile"><span class="k">FROM</span>        debian:jessie
<span class="k">MAINTAINER</span>  Apiary &lt;sre@apiary.io&gt;

<span class="k">ENV</span> REFRESHED_AT 2015-11-03

COPY requirements.txt /tmp/

<span class="k">RUN</span> apt-get clean <span class="o">&amp;&amp;</span> <span class="err">\</span>
    apt-get update <span class="o">&amp;&amp;</span> <span class="err">\</span>
    apt-get install -y --no-install-recommends python-sphinx <span class="err">\</span>
    graphviz <span class="err">\</span>
    make <span class="err">\</span>
    python-pip <span class="o">&amp;&amp;</span> <span class="err">\</span>
    pip install -r /tmp/requirements.txt <span class="o">&amp;&amp;</span> <span class="err">\</span>
    rm -rf /usr/share/doc/* <span class="o">&amp;&amp;</span> <span class="err">\</span>
    rm -rf /usr/share/locale/* <span class="o">&amp;&amp;</span> <span class="err">\</span>
    rm -rf /var/cache/debconf/*-old <span class="o">&amp;&amp;</span> <span class="err">\</span>
    rm -rf /var/lib/apt/lists/* <span class="o">&amp;&amp;</span> <span class="err">\</span>
    apt-get autoclean -y <span class="o">&amp;&amp;</span> <span class="err">\</span>
    apt-get autoremove -y

<span class="k">RUN</span> mkdir /mnt/docs

<span class="k">WORKDIR</span> /mnt/docs
<span class="k">VOLUME</span> <span class="o">[</span><span class="s1">&#39;/mnt/docs&#39;</span><span class="o">]</span>

<span class="k">CMD</span> make clean html
</code></pre></div>
<p>for running in repository with documentation you can use simple shell script, with support html and latex version. <a href="https://github.com/apiaryio/docker-base-images/blob/master/sphinx-latex-doc-dev/Dockerfile">Latex image size</a> is more than 1GB. Html version have only 100MB.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">#!/bin/bash
if [[ &quot;$@&quot; =~ latex.* ]]; then
    echo &quot;Building with LaTex image&quot;
    docker run -ti --rm -v $(pwd):/mnt/docs:rw -w /mnt/docs apiaryio/base-sphinx-latex-doc-dev $@
else
    echo &quot;Building with html-only image&quot;
    docker run -ti --rm -v $(pwd):/mnt/docs:rw -w /mnt/docs apiaryio/base-sphinx-doc-dev $@
fi
</code></pre></div>
<p>Using is very simple just run <code>./build.sh</code> and <code>open build/html/index.html</code>. You can use your favorite editor to edit sources and after that just run build again and check in browser. This version supports <a href="http://sphinx-doc.org/rest.html">reStructuredText</a> and <a href="https://help.github.com/articles/markdown-basics/">markdown</a>. You can combine both formats into your documentation. I prefer using markdown for simple text as this blog, but for complex documentation with references is better use reStructuredText (rst) format.</p>

<p>If you like write the docs, please check <a href="http://www.writethedocs.org/">Write the Docs</a> conferences and meetups.</p>

<p>See you tomorrow,<br>
Ladislav</p>

</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
        <h3>
          <a href="/2015/12/24/day-twenty-four-docker-advent-summary/">
            Day Twenty Four - Docker Advent Summary 2015
            <small>24 Dec 2015</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2015/12/23/day-twenty-three-docker-tips-and-tricks/">
            Day Twenty Three - Docker tips and tricks
            <small>23 Dec 2015</small>
          </a>
        </h3>
      </li>
    
      <li>
        <h3>
          <a href="/2015/12/22/day-twenty-two-docker-and-monitoring/">
            Day Twenty Two - Docker and monitoring
            <small>22 Dec 2015</small>
          </a>
        </h3>
      </li>
    
  </ul>
</div>

    </div>

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-37693925-3', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>
