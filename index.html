<!DOCTYPE html>
<html lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Docker Advent &middot; Small thoughts about docker in advent
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          Docker Advent
        </a>
      </h1>
      <p class="lead">Made by <a href="https://twitter.com/abtris" target="_blank">@abtris</a>.</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item active" href="/">Home</a>

      

      
      
        
          
        
      
        
          
            <a class="sidebar-nav-item" href="/about/">About</a>
          
        
      
        
      
        
      
        
          
        
      
        
      
        
          
        
      
        
          
        
      

      <a class="sidebar-nav-item" href="https://github.com/abtris/dockeradvent.com">GitHub project</a>
    </nav>

    <p>&copy; 2015. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/12/20/day-twenty-docker-and-tutum/">
        Day Twenty - Docker and Tutum
      </a>
    </h1>

    <span class="post-date">20 Dec 2015</span>

    
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/12/20/day-nineteen-docker-and-aws-ecs/">
        Day Nineteen - Docker and AWS ECS
      </a>
    </h1>

    <span class="post-date">20 Dec 2015</span>

    <p>Hi everyone,<br>
Amazon Web Services (AWS) is biggest cloud provider and you can use docker with Elastic Compute Cloud (EC2), use Amazon EC2 Container Service (ECS) or AWS Elastic Beanstalk. <a href="https://aws.amazon.com/elasticbeanstalk/">AWS Elastic Beanstalk</a> is very similar to Heroku. It&#39;s Platform as a Service (PaaS).</p>

<p>I write post about ECS. ECS is new service exists two years. You have to use your EC2 instances to provide cluster. No price for service itself only for resources (EC2, ELB, EBS).</p>

<p>This year <a href="https://github.com/aws/amazon-ecs-cli">Amazon ECS CLI</a> introduce support for <code>docker-compose.yml</code>.</p>

<p>I use this command to create task definition for ECS using this command:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">AWS_REGION=us-east-1 ecs-cli compose create
</code></pre></div>
<p>this is example <code>docker-compose.yml</code> for docker registry:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">backend:
  image: registry
  cpu_shares: 400
  mem_limit: 314572800
  ports:
    - 5000:5000
  environment:
    AWS_BUCKET: &lt;DOCKER-REGISTRY-BUCKET&gt;
    AWS_ENCRYPT: &#39;False&#39;
    AWS_KEY: &lt;AWS-KEY&gt;
    AWS_REGION: us-east-1
    AWS_SECRET: &lt;AWS-SECRET&gt;
    AWS_SECURE: &#39;False&#39;
    AWS_USE_SIGV4: &#39;False&#39;
    SETTINGS_FLAVOR: prod
    SEARCH_BACKEND: sqlalchemy
    REGISTRY_AUTH: htpasswd
    REGISTRY_AUTH_HTPASSWD_REALM: &#39;Auth Internal Registry&#39;
    REGISTRY_AUTH_HTPASSWD_PATH: /auth/htpasswd
</code></pre></div>
<p>For running cluster you need <a href="http://docs.aws.amazon.com/AmazonECS/latest/developerguide/launch_container_instance.html">setup instances</a> and register these instances into cluster. You can use <a href="http://docs.aws.amazon.com/AmazonECS/latest/developerguide/ecs-agent-config.html#ecs-config-s3">ecs.config</a> in user data to setup instance.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">#!/bin/bash
yum install -y aws-cli
aws s3 cp s3://&lt;BUCKET-NAME&gt;/ecs.config /etc/ecs/ecs.config
echo ECS_CLUSTER=&lt;CLUSTER-NAME&gt; &gt;&gt; /etc/ecs/ecs.config
</code></pre></div>
<p>You can run task or service in ECS. If you need task as cron you can use lambda for setup <a href="http://stackoverflow.com/questions/27382009/aws-lambda-scheduled-tasks">scheduling task</a>.</p>
<div class="highlight"><pre><code class="language-js" data-lang="js"><span class="kd">var</span> <span class="nx">AWS</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;aws-sdk&#39;</span><span class="p">);</span>
<span class="nx">AWS</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">region</span> <span class="o">=</span> <span class="s1">&#39;us-east-1&#39;</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">ecs</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">AWS</span><span class="p">.</span><span class="nx">ECS</span><span class="p">();</span>

<span class="kr">const</span> <span class="nx">MAX_RESULTS</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">runTask</span><span class="p">(</span><span class="nx">taskDefinitionArn</span><span class="p">,</span> <span class="nx">clusterName</span><span class="p">,</span> <span class="nx">numberOfTasks</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">taskDefinition</span><span class="o">:</span> <span class="nx">taskDefinitionArn</span><span class="p">,</span> <span class="cm">/* required */</span>
    <span class="nx">cluster</span><span class="o">:</span> <span class="nx">clusterName</span><span class="p">,</span>
    <span class="nx">count</span><span class="o">:</span> <span class="nx">numberOfTasks</span><span class="p">,</span>
    <span class="nx">overrides</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
    <span class="nx">startedBy</span><span class="o">:</span> <span class="s1">&#39;nodejs-script&#39;</span>
  <span class="p">};</span>
  <span class="nx">ecs</span><span class="p">.</span><span class="nx">runTask</span><span class="p">(</span><span class="nx">params</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">err</span><span class="p">.</span><span class="nx">stack</span><span class="p">);</span> <span class="c1">// an error occurred</span>
    <span class="k">else</span>     <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">);</span>           <span class="c1">// successful response</span>
  <span class="p">});</span>
<span class="p">}</span>

<span class="nx">exports</span><span class="p">.</span><span class="nx">handler</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">event</span><span class="p">,</span> <span class="nx">context</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">context</span><span class="p">.</span><span class="nx">succeed</span><span class="p">(</span><span class="nx">runTask</span><span class="p">(</span><span class="s1">&#39;&lt;TASK-NAME&gt;&#39;</span><span class="p">,</span> <span class="s1">&#39;&lt;CLUSTER-NAME&gt;&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">));</span>
<span class="p">};</span>
</code></pre></div>
<p>If you can run service it&#39;s similar but service is still alive. You can combine ECS with <a href="https://mesosphere.github.io/marathon/">Marathon</a> or <a href="http://mesos.github.io/chronos/">Chronos</a>.</p>

<p>See you tomorrow,<br>
Ladislav</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/12/18/day-eighteen-docker-and-heroku/">
        Day Eighteen - Docker and Heroku
      </a>
    </h1>

    <span class="post-date">18 Dec 2015</span>

    <p>Hi everyone,<br>
many PaaS (platform as service) support docker for deployment. I can write some posts about this. I start with Heroku.</p>

<p>Heroku introduce have own container solution for many years and <a href="https://devcenter.heroku.com/articles/docker">docker solution</a> converts docker images into their format. You can combine <code>git push heroku master</code> with <code>heroku docker:release</code> and both works together.</p>

<p>First, you have to update your heroku client and add docker plugin.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">heroku plugins:install heroku-docker
</code></pre></div>
<p>second, edit or create your <code>app.json</code> and add <code>image</code>.</p>

<p>Heroku maintains Docker images for most of the languages that we support:</p>

<ul>
<li>heroku/nodejs</li>
<li>heroku/ruby</li>
<li>heroku/jruby</li>
<li>heroku/python</li>
<li>heroku/scala</li>
<li>heroku/clojure</li>
<li>heroku/gradle</li>
<li>heroku/java</li>
<li>heroku/go</li>
<li>heroku/go-gb</li>
</ul>

<p>Third, you need <code>Procfile</code> as normal heroku app. And run <code>heroku docker:init</code>. Heroku create <code>Dockerfile</code> and <code>docker-compose.yml</code> file for you.</p>

<p>For local development just run <code>docker-compose up web</code> and app can be open at <code>open &quot;http://$(docker-machine ip default):8080&quot;</code></p>

<p>If you need shell (for example for Ruby app), you can run <code>docker-compose run shell</code>.</p>

<p>Rebuild container using <code>docker-compose build</code>. This you need if you change config or app.</p>

<p>Deploy is easy.</p>

<ol>
<li>Create Heroku app: <code>heroku create</code></li>
<li>Push slug into Heroku: <code>heroku docker:release</code></li>
<li>Open app in browser: <code>heroku open</code></li>
</ol>

<p>All docker images from heroku you can find at <a href="https://hub.docker.com/r/heroku/">dockerhub</a>.</p>

<p>If you need some special Dockerfile you can <a href="https://devcenter.heroku.com/articles/docker#modifying-the-dockerfile">make own</a>. This steps have some <a href="https://devcenter.heroku.com/articles/docker#limitations">limitations</a> if you use own buildpack you have to use standard pipeline.</p>

<p>See you tomorrow,<br>
Ladislav</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/12/17/day-seventeen-docker-and-sphinx-documentation/">
        Day Seventeen - Docker and Sphinx documentation
      </a>
    </h1>

    <span class="post-date">17 Dec 2015</span>

    <p>Hi everyone,<br>
if you write the docs, you can use <a href="http://sphinx-doc.org/">Sphinx</a>. You can share your documentation using <a href="https://readthedocs.org/">Read the Docs</a> portal.</p>

<p>If you look at <a href="https://docs.readthedocs.org/en/latest/getting_started.html#write-your-docs">quickstart</a> how write the docs, you can install python and some tools. This can be complicated if you can use latex for creating PDF version and do you need another version python for your development and some another for write the docs. Some members of your team can&#39;t install anything for update just a few lines.</p>

<h2>Docker solution for Sphinx</h2>

<p>You can use <a href="https://hub.docker.com/r/apiaryio/base-sphinx-doc-dev/">docker image</a>. There is <code>requirements.txt</code> for all python packages:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">Sphinx&gt;=1.3.1
awscli==1.5.2
sphinx_rtd_theme
recommonmark
</code></pre></div>
<p>and Dockerfile based on debian.</p>
<div class="highlight"><pre><code class="language-dockerfile" data-lang="dockerfile"><span class="k">FROM</span>        debian:jessie
<span class="k">MAINTAINER</span>  Apiary &lt;sre@apiary.io&gt;

<span class="k">ENV</span> REFRESHED_AT 2015-11-03

COPY requirements.txt /tmp/

<span class="k">RUN</span> apt-get clean <span class="o">&amp;&amp;</span> <span class="err">\</span>
    apt-get update <span class="o">&amp;&amp;</span> <span class="err">\</span>
    apt-get install -y --no-install-recommends python-sphinx <span class="err">\</span>
    graphviz <span class="err">\</span>
    make <span class="err">\</span>
    python-pip <span class="o">&amp;&amp;</span> <span class="err">\</span>
    pip install -r /tmp/requirements.txt <span class="o">&amp;&amp;</span> <span class="err">\</span>
    rm -rf /usr/share/doc/* <span class="o">&amp;&amp;</span> <span class="err">\</span>
    rm -rf /usr/share/locale/* <span class="o">&amp;&amp;</span> <span class="err">\</span>
    rm -rf /var/cache/debconf/*-old <span class="o">&amp;&amp;</span> <span class="err">\</span>
    rm -rf /var/lib/apt/lists/* <span class="o">&amp;&amp;</span> <span class="err">\</span>
    apt-get autoclean -y <span class="o">&amp;&amp;</span> <span class="err">\</span>
    apt-get autoremove -y

<span class="k">RUN</span> mkdir /mnt/docs

<span class="k">WORKDIR</span> /mnt/docs
<span class="k">VOLUME</span> <span class="o">[</span><span class="s1">&#39;/mnt/docs&#39;</span><span class="o">]</span>

<span class="k">CMD</span> make clean html
</code></pre></div>
<p>for running in repository with documentation you can use simple shell script, with support html and latex version. <a href="https://github.com/apiaryio/docker-base-images/blob/master/sphinx-latex-doc-dev/Dockerfile">Latex image size</a> is more than 1GB. Html version have only 100MB.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">#!/bin/bash
if [[ &quot;$@&quot; =~ latex.* ]]; then
    echo &quot;Building with LaTex image&quot;
    docker run -ti --rm -v $(pwd):/mnt/docs:rw -w /mnt/docs apiaryio/base-sphinx-latex-doc-dev $@
else
    echo &quot;Building with html-only image&quot;
    docker run -ti --rm -v $(pwd):/mnt/docs:rw -w /mnt/docs apiaryio/base-sphinx-doc-dev $@
fi
</code></pre></div>
<p>Using is very simple just run <code>./build.sh</code> and <code>open build/html/index.html</code>. You can use your favorite editor to edit sources and after that just run build again and check in browser. This version supports <a href="http://sphinx-doc.org/rest.html">reStructuredText</a> and <a href="https://help.github.com/articles/markdown-basics/">markdown</a>. You can combine both formats into your documentation. I prefer using markdown for simple text as this blog, but for complex documentation with references is better use reStructuredText (rst) format.</p>

<p>If you like write the docs, please check <a href="http://www.writethedocs.org/">Write the Docs</a> conferences and meetups.</p>

<p>See you tomorrow,<br>
Ladislav</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/12/16/day-sixteen-using-docker-for-cli-tools/">
        Day Sixteen - Using docker for CLI Tools
      </a>
    </h1>

    <span class="post-date">16 Dec 2015</span>

    <p>Hi everyone,<br>
I like one thing at docker and that is isolation. For example we have <a href="https://github.com/apiaryio/polls-api">project Polls API</a> written in Python. For testing API we use tool named <a href="http://dredd.readthedocs.org/en/latest/">Dredd</a> written in NodeJS. I can&#39;t install NodeJS to our system. But you can easy use Docker to solve this problem.</p>

<p>Here is <code>circle.yml</code> file for project:</p>
<div class="highlight"><pre><code class="language-yaml" data-lang="yaml"><span class="l-Scalar-Plain">machine</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">pre</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">echo &#39;DOCKER_OPTS=&quot;-s btrfs -e lxc -D --userland-proxy=false&quot;&#39; | sudo tee -a /etc/default/docker</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">sudo curl -L -o /usr/bin/docker &#39;https://s3-external-1.amazonaws.com/circle-downloads/docker-1.8.3-circleci&#39;</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">sudo chmod 0755 /usr/bin/docker</span>
  <span class="l-Scalar-Plain">services</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">docker</span>
<span class="l-Scalar-Plain">dependencies</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">cache_directories</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="s">&quot;~/bin/docker-compose/&quot;</span>
  <span class="l-Scalar-Plain">override</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">docker info</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">docker version</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">if [[ ! -e ~/bin/docker-compose ]]; then mkdir ~/bin/docker-compose/ &amp;&amp; curl -L https://github.com/docker/compose/releases/download/1.4.2/docker-compose-`uname -s`-`uname -m` &gt; ~/bin/docker-compose/docker-compose &amp;&amp; chmod +x ~/bin/docker-compose/docker-compose; fi</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">~/bin/docker-compose/docker-compose --version</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">~/bin/docker-compose/docker-compose pull</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">docker pull apiaryio/dredd</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">~/bin/docker-compose/docker-compose build</span>
<span class="l-Scalar-Plain">test</span><span class="p-Indicator">:</span>
  <span class="l-Scalar-Plain">pre</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">~/bin/docker-compose/docker-compose up -d web</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">~/bin/docker-compose/docker-compose run shell python manage.py migrate</span>
  <span class="l-Scalar-Plain">override</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">~/bin/docker-compose/docker-compose run shell python manage.py test</span>
  <span class="l-Scalar-Plain">post</span><span class="p-Indicator">:</span>
    <span class="p-Indicator">-</span> <span class="l-Scalar-Plain">./scripts/dredd</span>
</code></pre></div>
<p>and bash script for running dredd is:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">#!/bin/bash
# set -x
which docker-compose &gt; /dev/null 1&gt;&amp;1
if [ $? -eq 0 ]; then
  DOCKER_COMPOSE=&#39;docker-compose&#39;
else
  if [ -f ~/bin/docker-compose/docker-compose ]; then
    DOCKER_COMPOSE=&quot;$HOME/bin/docker-compose/docker-compose&quot;
  else
    echo &quot;Cannot find docker-compose!&quot;
    exit 1
  fi
fi
# Sync the database
$DOCKER_COMPOSE run -e DATABASE_URL=sqlite:///dredd.sqlite shell &quot;python manage.py migrate&quot;
# Run the dev server
$DOCKER_COMPOSE up -d web
IPWEB=`docker ps  | grep pollsapi_web | cut -d &#39; &#39; -f1 | xargs docker inspect  | grep IPAddress\&quot;: | cut -d &quot;:&quot; -f2 | tr -d &quot;\&quot;&quot; | tr -d &quot;,&quot; | tr -d &#39;[[:space:]]&#39;`
# Run dredd
docker run -v $(pwd):/root -w /root apiaryio/dredd dredd apiary.apib http://$IPWEB:8080
RESULT=$?
exit $RESULT
</code></pre></div>
<p>You can see setup database using docker-compose. After running web, I get IP address for python server and using this address as parameter for running dredd command.</p>

<p>If you can create image for some tools you can make it as I did for Dredd.</p>
<div class="highlight"><pre><code class="language-dockerfile" data-lang="dockerfile"><span class="k">from</span> node:0.12

<span class="k">RUN</span> npm install -g dredd

<span class="k">CMD</span> dredd
</code></pre></div>
<p>It&#39;s easy and depends on your tool. Sometimes is better use <code>ENTRYPOINT</code> and <code>CMD</code>. Dredd works out of box without parameters using <code>dredd.yml</code> config. For example API Blueprint parser <a href="https://github.com/apiaryio/drafter">drafter</a> waiting for input from stdin. There is better using <code>ENTRYPOINT</code> and <code>CMD</code> with <code>-h</code> as default parameter.</p>
<div class="highlight"><pre><code class="language-dockerfile" data-lang="dockerfile"><span class="k">FROM</span> apiaryio/base-dev-cpp:1.0.0
<span class="k">MAINTAINER</span> Apiary <span class="s2">&quot;sre@apiary.io&quot;</span>


<span class="k">RUN</span> locale-gen en_US.UTF-8
<span class="k">RUN</span> <span class="nb">echo</span> <span class="s2">&quot;LC_ALL=en_US.UTF-8&quot;</span> &gt;&gt; /etc/default/locale
<span class="k">RUN</span> dpkg-reconfigure locales

<span class="k">ADD</span> ./ /drafter

<span class="k">WORKDIR</span> /drafter

<span class="c"># It&#39;s tempting to put ./configure into RUN, but then you have timestamp issues</span>

<span class="k">RUN</span> ./configure <span class="o">&amp;&amp;</span> make all <span class="o">&amp;&amp;</span> make install

<span class="k">ENTRYPOINT</span> /usr/local/bin/drafter
<span class="k">CMD</span> <span class="s2">&quot;-h&quot;</span>
</code></pre></div>
<p>See you tomorrow,<br>
Ladislav</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/12/15/day-fifteen-container-lifecycle/">
        Day Fifteen - Container Lifecycle
      </a>
    </h1>

    <span class="post-date">15 Dec 2015</span>

    <p>Hi everyone,<br>
 I can write some details about docker containers lifecycle.</p>

<h2>Container statuses</h2>

<ul>
<li>running</li>
<li>stopped</li>
<li>paused</li>
<li>killed</li>
<li>removed</li>
</ul>

<h2>How change status</h2>

<ul>
<li>image -&gt; <code>docker run</code> -&gt; running</li>
<li>running -&gt; <code>docker pause</code> -&gt; paused -&gt; <code>docker unpause</code> -&gt; running</li>
<li>running -&gt; <code>docker stop</code> -&gt; stopped -&gt; <code>docker start</code> -&gt; running</li>
<li>stopped -&gt; <code>docker rm</code> -&gt; removed</li>
<li>running -&gt; <code>docker kill</code> -&gt; killed -&gt; <code>docker rm</code> -&gt; removed</li>
<li>running -&gt; <code>docker rm --force</code> -&gt; removed</li>
<li>running -&gt; <code>docker restart</code> -&gt; stopped -&gt; running</li>
</ul>

<h2>Docker container lifecycle schema</h2>

<p><img src="/assets/docker-lifecycle-3.png" alt="Docker Container Lifecycle"></p>

<p>You can see you have many containers, sometimes problems with space in VM. Docker consumes big amount of disk space. I use this script <code>docker-cleanup</code> for cleanup my VM. First command remove containers and second remove images.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">#!/bin/bash
# Delete all containers
docker rm $(docker ps -a -q)
# Delete all images
docker rmi $(docker images -q)
</code></pre></div>
<p>See you tomorrow,<br>
Ladislav</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/12/14/day-fourteen-docker-lifecycle/">
        Day Fourteen - Docker Lifecycle
      </a>
    </h1>

    <span class="post-date">14 Dec 2015</span>

    <p>Hi everyone,<br>
 I can write some details about docker containers. How images and containers born and die.</p>

<h2>Steps in lifecycle</h2>

<ol>
<li>You have to <code>build</code> <strong>image</strong>. Make <a href="http://localhost:4000/2015/12/07/day-seven-dockerfile/"><code>Dockerfile</code></a> and run <code>docker build</code>.</li>
</ol>

<ul>
<li>you can run <code>docker build .</code></li>
<li>or you add tag name <code>docker build -t username/my-imagename .</code></li>
<li>or you can have <code>Dockerfile</code> somewhere at path <code>docker build -t username/my-imagename -f /path/Dockerfile</code></li>
</ul>

<ol>
<li><p>If you run image by <code>docker run</code> you create <strong>container</strong>. You can check them by <code>docker ps</code>.</p></li>
<li><p>Container can be in different status, you can stop them by <code>docker stop</code>.</p></li>
<li><p>If you make some changes by using terminal <code>docker run -it &lt;image-name&gt; /bin/bash</code> or <code>docker exec -it &lt;container-id&gt; /bin/bash</code>. You can change this <strong>container</strong> into <strong>image</strong>. You have to use <code>docker commit</code> <a href="https://docs.docker.com/engine/reference/commandline/commit/">command</a>.</p></li>
</ol>

<h2>Docker lifecycle schema</h2>

<p><img src="/assets/docker-lifecycle-2.png" alt="Docker Container Lifecycle"></p>

<p>Next, I write post about details and all commands and statuses docker container.</p>

<p>See you tomorrow,<br>
Ladislav</p>

  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/2015/12/13/day-thirteen-docker-and-travisci/">
        Day Thirteen - Docker and TravisCI
      </a>
    </h1>

    <span class="post-date">13 Dec 2015</span>

    <p>Hi everyone,<br>
Docker is great for testing. In last post I write about <a href="http://www.dockeradvent.com/2015/12/12/day-twelve-docker-and-circleci/">CircleCI</a>.</p>

<h2>Travis CI</h2>

<p>TravisCI is most used in Open Source projects at GitHub.</p>

<p>To use Docker add the following settings to your <code>.travis.yml</code>:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">sudo: required

services:
  - docker
</code></pre></div>
<p>You can use <code>docker-compose</code> in similar way as in CircleCI.</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">env:
  DOCKER_COMPOSE_VERSION: 1.4.2

before_install:
  - sudo rm /usr/local/bin/docker-compose
  - curl -L https://github.com/docker/compose/releases/download/${DOCKER_COMPOSE_VERSION}/docker-compose-`uname -s`-`uname -m` &gt; docker-compose
  - chmod +x docker-compose
  - sudo mv docker-compose /usr/local/bin
</code></pre></div>
<p>I&#39;m not sure about TravisCI and <a href="https://docs.travis-ci.com/user/caching">caching</a> used for docker. TravisCI using docker for normal build too, if you use <code>sudo: false</code> your build using docker at backend.</p>

<h2>Continues Engines</h2>

<p>Many CI systems exists for example <a href="https://drone.io/">drone.io</a> is build at top of docker. It&#39;s have only simple documentation with basics commands showing UI.</p>

<p>We have new generation CI as <a href="http://devcenter.wercker.com/docs/pipelines/per-pipeline-containers.html">Wercker</a> or <a href="https://buildkite.com/docs/guides/docker-containerized-builds">BuildKite</a> with pipelines and better support using docker.</p>

<p>Only future show us who win this battle for best continuous delivery tool.</p>

<p>See you tomorrow,<br>
Ladislav</p>

  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page2">Older</a>
  
  
    <span class="pagination-item newer">Newer</span>
  
</div>
    </div>

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-37693925-3', 'auto');
  ga('send', 'pageview');

</script>

  </body>
</html>
